import pandas as pd

# 2019 데이터
data_2019 = {
    "업종": ["소매", "숙박", "스포츠", "오락", "음식", "합계"],
    "합계": [396696, 14451, 7284, 36246, 408035, 862712]
}

# 2023 데이터
data_2023 = {
    "업종": ["소매", "숙박", "스포츠", "오락", "음식", "합계"],
    "합계": [295508, 24922, 22549, 27501, 393167, 763647]
}

# 데이터프레임 생성
df_2019 = pd.DataFrame(data_2019).set_index("업종")
df_2023 = pd.DataFrame(data_2023).set_index("업종")

# 변화율 계산
change_rate = ((df_2023["합계"] - df_2019["합계"]) / df_2019["합계"] * 100).round(2)

# 회복률 계산
recovery_rate = (df_2023["합계"] / df_2019["합계"] * 100).round(2)

# 결과 데이터프레임 생성
change_rate_df = pd.DataFrame({
    "업종": df_2019.index,
    "2019 합계": df_2019["합계"],
    "2023 합계": df_2023["합계"],
    "변화율 (%)": change_rate,
    "회복률 (%)": recovery_rate
}).reset_index(drop=True)